package ATM;

import java.util.Scanner;

public class ATM {

	public static void main(String[] args) {

		Scanner sc = new Scanner(System.in);

		Bank theBank = new Bank("Royal Bank Canada");

		// adding first user with saving Account
		User user = theBank.addUser("Esmaeil", "Changizi", "12345");

		Account newAccount = new Account("Chacking", user, theBank);
		user.addAccount(newAccount);
		theBank.addAccount(newAccount);

		User curUser;
		while (true) {

			// stay in login prompt until successful login
			curUser = ATM.mainMenuPrompt(theBank, sc);

			ATM.printUserMenu(curUser, sc);
		}

	}

////////////////////////////////////////////////////////////////////////////////
	public static User mainMenuPrompt(Bank theBank, Scanner sc) {
		String userID;
		String pin;
		User authUser;

		do {
			System.out.printf("\n\n WELCOME TO %s", theBank.getName());
			System.out.println("Enter user ID : ");
			userID = sc.nextLine();
			System.out.print("Enter pin Number :");
			pin = sc.nextLine();

			authUser = theBank.userLogin(userID, pin);
			if (authUser == null) {
				System.out.println("Incorrect userid/pin number.please try again.");
			}
		} while (authUser == null);
		return authUser;
	}

/////////////////////////////////////////////////////////////////////////////
	public static void printUserMenu(User user,Scanner sc) {
		user.printAccountsSummary();
		
		int choice;
		
		do {
			
			System.out.printf("Welcome %s ,what you would like you to do? ",user.getFirstName());
			System.out.println(" 1) Show account Transaction");
			System.out.println(" 2) Withdraw.");
			System.out.println(" 3) Deposit.");
			System.out.println(" 4) Transfer.");
			System.out.println(" 5) Quit.\n");
			
			System.out.println("Enter your choice.");
			choice = sc.nextInt();
			
			if(choice<1 || choice>5) {
				System.out.println("Invalid choice,Enter 1-5");
			}
					
		}while(choice<1 || choice>5);
		
		
		switch(choice){
		
		case1:
			ATM.showTransHistory(user,sc);
		    break;
		case 2:
			ATM.withdrawlFunds(user,sc);
			break;
		case 3:
			ATM.depositFunds(user,sc);
			break;
		case 4:
			ATM.transferFunds(user,sc);
			break;		
		}
		
		if(choice != 5) {
			ATM.printUserMenu(user, sc);
		}	
	}
	///////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	public static void showTransHistory(User user,Scanner sc) {
		
		int theAcct;
		
		do {
			System.out.printf("Enter the number (1-%d) of the accounts\n"+
		"whose transaction you want to see.", user.numAccounts());
			theAcct = sc.nextInt()-1;
			if(theAcct < 0 || theAcct>=user.numAccounts()) {
				System.out.println("Invalid input");
			}
			
		}while(theAcct < 0 || theAcct>=user.numAccounts());
		
		user.printAcctTransHistory();
		
		
	}

}
